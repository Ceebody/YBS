<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Word Processing Quiz</title>
  <script type="module">
    // Import Firebase modules
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getDatabase, ref, push, set } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyDgqz8...yourapikey...",
      authDomain: "yourapp.firebaseapp.com",
      databaseURL: "https://yourapp.firebaseio.com",
      projectId: "yourapp",
      storageBucket: "yourapp.appspot.com",
      messagingSenderId: "123456789",
      appId: "1:123456789:web:abc123"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // Quiz Data
    const quizData = [
      { q: "1. Microsoft Word is an example of a __________ software.", answer: "Word processing" },
      { q: "2. The part of Microsoft Word that shows the file name and program name is called the __________ bar.", answer: "Title" },
      { q: "3. The blinking vertical line that shows where text will appear when you type is called the __________.", answer: "Cursor" },
      { q: "4. The group that contains the Cut, Copy, and Paste commands is the __________ group.", answer: "Clipboard" },
      { q: "5. To remove a word or sentence from one place and insert it somewhere else, use the __________ command.", answer: "Cut" },
      { q: "6. The __________ command makes a duplicate of the selected text or object.", answer: "Copy" },
      { q: "7. To place copied or cut text into a new position, use the __________ command.", answer: "Paste" },
      { q: "8. The feature that allows you to search for a specific word or phrase in a document is called __________.", answer: "Find" },
      { q: "9. The feature used to automatically change a word or phrase in a document is called __________.", answer: "Replace" },
      { q: "10. A __________ is a grid made of rows and columns that organizes data neatly in a document.", answer: "Table" },
      { q: "11. The command used to combine two or more cells into one is called __________.", answer: "Merge Cells" },
      { q: "12. To divide one cell into smaller ones, use the __________ command.", answer: "Split Cells" },
      { q: "13. The tab that contains the Table and Picture options is called the __________ tab.", answer: "Insert" },
      { q: "14. A __________ in Word allows users to jump to another document, a webpage, or another part of the same document.", answer: "Hyperlink" },
      { q: "15. When text is too long for one page, Word automatically moves it to the next page. This is called __________.", answer: "Word wrap" },
      { q: "16. The __________ tool checks your spelling and grammar mistakes in a document.", answer: "Spelling and Grammar checker" },
      { q: "17. To make text bold, italic, or underlined, you use the tools in the __________ group.", answer: "Font" },
      { q: "18. You can change the font style and size from the __________ tab.", answer: "Home" },
      { q: "19. To select all the text in a document, press __________ + A on the keyboard.", answer: "Ctrl" },
      { q: "20. The part of the screen where you type your text is called the __________ area.", answer: "Document" }
    ];

    // Section B Theory Questions
    const theoryQuestions = [
      {
        q: "1. Name any three commands found in the Editing group on the Home tab.",
        expectedKeywords: ["find", "replace", "select"]
      },
      {
        q: "2. Mention two types of places a hyperlink can lead to.",
        expectedKeywords: ["webpage", "document", "email", "file"]
      },
      {
        q: "3. Explain the difference between Cut and Copy.",
        expectedKeywords: ["cut", "remove", "copy", "duplicate", "original"]
      }
    ];

    // Function to check theory answers
    function checkTheoryAnswer(userAnswer, expectedKeywords) {
      userAnswer = userAnswer.toLowerCase();
      let score = 0;
      expectedKeywords.forEach(keyword => {
        if (userAnswer.includes(keyword)) score++;
      });
      return score >= Math.ceil(expectedKeywords.length / 2);
    }

    window.onload = () => {
      const quizContainer = document.getElementById("quiz");
      const theoryContainer = document.getElementById("theory");
      const submitBtn = document.getElementById("submit");
      const nameInput = document.getElementById("studentName");

      // Render Section A
      quizData.forEach((item, index) => {
        quizContainer.innerHTML += `
          <div class="question">
            <p>${item.q}</p>
            <input type="text" id="q${index}" placeholder="Your answer here..." />
          </div>`;
      });

      // Render Section B
      theoryQuestions.forEach((item, index) => {
        theoryContainer.innerHTML += `
          <div class="question">
            <p>${item.q}</p>
            <textarea id="t${index}" rows="3" placeholder="Type your answer..."></textarea>
          </div>`;
      });

      // Handle Submit
      submitBtn.onclick = () => {
        const studentName = nameInput.value.trim();
        if (!studentName) {
          alert("Please enter your name before submitting.");
          return;
        }

        let sectionAScore = 0;
        let sectionBScore = 0;

        // Section A Scoring
        quizData.forEach((item, index) => {
          const ans = document.getElementById(`q${index}`).value.trim().toLowerCase();
          if (ans.includes(item.answer.toLowerCase())) sectionAScore++;
        });

        // Section B Scoring
        theoryQuestions.forEach((item, index) => {
          const ans = document.getElementById(`t${index}`).value.trim();
          if (checkTheoryAnswer(ans, item.expectedKeywords)) sectionBScore += 2; // 2 marks each
        });

        const totalScore = sectionAScore + sectionBScore;

        // Save to Firebase
        const quizRef = ref(db, "quizResults");
        const newEntry = push(quizRef);
        set(newEntry, {
          name: studentName,
          sectionA: sectionAScore,
          sectionB: sectionBScore,
          total: totalScore,
          date: new Date().toLocaleString()
        });

        alert(`✅ ${studentName}, your quiz is submitted!\n\nSection A: ${sectionAScore}\nSection B: ${sectionBScore}\nTotal: ${totalScore}`);
      };
    };
  </script>

  <style>
    body {
      font-family: "Poppins", sans-serif;
      background: #f4f6fa;
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #2b4d90;
    }
    .section-title {
      font-weight: bold;
      color: #1f3a7d;
      margin-top: 20px;
    }
    .question {
      background: white;
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 10px;
      box-shadow: 0 0 3px rgba(0,0,0,0.1);
    }
    input, textarea {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    button {
      background: #2b4d90;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      display: block;
      margin: 20px auto;
    }
    #studentName {
      display: block;
      margin: 0 auto 20px auto;
      padding: 10px;
      width: 60%;
      font-size: 16px;
      border-radius: 6px;
      border: 1px solid #aaa;
    }
  </style>
</head>
<body>
  <h1>Word Processing Quiz</h1>
  <input type="text" id="studentName" placeholder="Enter your full name" />
  
  <h2 class="section-title">Section A – Fill in the Blanks</h2>
  <div id="quiz"></div>

  <h2 class="section-title">Section B – Theory Questions</h2>
  <div id="theory"></div>

  <button id="submit">Submit Quiz</button>
</body>
</html>
