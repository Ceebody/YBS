<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Word Processing Quiz</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      width: 90%;
      max-width: 900px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.95);
      padding: 30px;
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    h1 {
      text-align: center;
      color: #2c3e50;
      margin-bottom: 30px;
      font-size: 2.5em;
      font-weight: 700;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
    }
    
    h2 {
      color: #34495e;
      margin: 25px 0 20px 0;
      font-size: 1.5em;
      padding-bottom: 10px;
      border-bottom: 3px solid #3498db;
      position: relative;
    }
    
    h2::after {
      content: '';
      position: absolute;
      bottom: -3px;
      left: 0;
      width: 50px;
      height: 3px;
      background: #e74c3c;
    }
    
    .question {
      margin: 20px 0;
      padding: 20px;
      background: rgba(255, 255, 255, 0.7);
      border-radius: 12px;
      border-left: 4px solid #3498db;
      transition: all 0.3s ease;
    }
    
    .question:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    }
    
    .question p {
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 10px;
      font-size: 1.1em;
    }
    
    button {
      background: linear-gradient(135deg, #3498db, #2980b9);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 50px;
      cursor: pointer;
      margin-top: 30px;
      display: block;
      width: 100%;
      font-size: 1.1em;
      font-weight: 600;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    button:hover {
      background: linear-gradient(135deg, #2980b9, #3498db);
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(52, 152, 219, 0.4);
    }
    
    button:active {
      transform: translateY(0);
    }
    
    textarea {
      width: 100%;
      height: 100px;
      border-radius: 10px;
      border: 2px solid #bdc3c7;
      padding: 15px;
      font-family: inherit;
      font-size: 1em;
      resize: vertical;
      transition: border-color 0.3s ease;
    }
    
    textarea:focus {
      outline: none;
      border-color: #3498db;
      box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
    }
    
    input[type="text"] {
      width: 100%;
      padding: 15px;
      border-radius: 10px;
      border: 2px solid #bdc3c7;
      margin-bottom: 25px;
      font-size: 1.1em;
      transition: border-color 0.3s ease;
    }
    
    input[type="text"]:focus {
      outline: none;
      border-color: #3498db;
      box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
    }
    
    .fill-blank-input {
      display: inline-block;
      width: 200px;
      padding: 8px 12px;
      border: none;
      border-bottom: 2px solid #3498db;
      background: transparent;
      font-size: 1em;
      margin: 0 5px;
      text-align: center;
      transition: border-color 0.3s ease;
    }
    
    .fill-blank-input:focus {
      outline: none;
      border-bottom-color: #e74c3c;
    }
    
    .result {
      text-align: center;
      margin-top: 30px;
      padding: 25px;
      background: linear-gradient(135deg, #2ecc71, #27ae60);
      color: white;
      border-radius: 15px;
      font-size: 1.2em;
      font-weight: bold;
      box-shadow: 0 10px 30px rgba(46, 204, 113, 0.3);
    }
    
    .feedback {
      margin-top: 12px;
      padding: 10px;
      border-radius: 8px;
      font-size: 0.95em;
      animation: fadeIn 0.5s ease;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .correct {
      background: rgba(46, 204, 113, 0.1);
      color: #27ae60;
      border-left: 4px solid #27ae60;
    }
    
    .wrong {
      background: rgba(231, 76, 60, 0.1);
      color: #c0392b;
      border-left: 4px solid #c0392b;
    }
    
    .expected {
      color: #7f8c8d;
      font-style: italic;
      margin-top: 8px;
      padding: 8px;
      background: rgba(127, 140, 141, 0.1);
      border-radius: 6px;
    }
    
    .name-label {
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 10px;
      display: block;
      font-size: 1.1em;
    }
    
    .loading {
      opacity: 0.7;
      pointer-events: none;
    }
    
    .success-message {
      background: linear-gradient(135deg, #2ecc71, #27ae60);
      color: white;
      padding: 15px;
      border-radius: 10px;
      margin-top: 20px;
      text-align: center;
      font-weight: 600;
    }
    
    .error-message {
      background: linear-gradient(135deg, #e74c3c, #c0392b);
      color: white;
      padding: 15px;
      border-radius: 10px;
      margin-top: 20px;
      text-align: center;
      font-weight: 600;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üìù Word Processing Quiz</h1>
    <form id="quizForm">
      <label class="name-label">Enter your full name:</label>
      <input type="text" id="studentName" placeholder="Type your name here..." required>

      <h2>Section A: Fill in the Blanks (1 mark each)</h2>
      <div id="sectionA"></div>

      <h2>Section B: Theory Questions (10 marks each)</h2>
      <div id="sectionB"></div>

      <button type="button" onclick="submitQuiz()">Submit Quiz</button>
    </form>
    <div class="result" id="result" style="display: none;"></div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getDatabase, ref, push, set } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCY9oturc9bql33PSUkfNUptcHXla2RWN4",
      authDomain: "tracha-xx.firebaseapp.com",
      databaseURL: "https://tracha-xx-default-rtdb.firebaseio.com",
      projectId: "tracha-xx",
      storageBucket: "tracha-xx.appspot.com",
      messagingSenderId: "914440906583",
      appId: "1:914440906583:web:123abc456xyz"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const quizData = [
      { section: "A", q: "1. Microsoft Word is an example of a __________ software.", answer: "word processing" },
      { section: "A", q: "2. The part of Microsoft Word that shows the file name and program name is called the __________ bar.", answer: "title" },
      { section: "A", q: "3. The blinking vertical line that shows where text will appear when you type is called the __________.", answer: "cursor" },
      { section: "A", q: "4. The group that contains the Cut, Copy, and Paste commands is the __________ group.", answer: "clipboard" },
      { section: "A", q: "5. To remove a word or sentence from one place and insert it somewhere else, use the __________ command.", answer: "cut" },
      { section: "A", q: "6. The __________ command makes a duplicate of the selected text or object.", answer: "copy" },
      { section: "A", q: "7. To place copied or cut text into a new position, use the __________ command.", answer: "paste" },
      { section: "A", q: "8. The feature that allows you to search for a specific word or phrase in a document is called __________.", answer: "find" },
      { section: "A", q: "9. The feature used to automatically change a word or phrase in a document is called __________.", answer: "replace" },
      { section: "A", q: "10. A __________ is a grid made of rows and columns that organizes data neatly in a document.", answer: "table" },
      { section: "A", q: "11. The command used to combine two or more cells into one is called __________.", answer: "merge cells" },
      { section: "A", q: "12. To divide one cell into smaller ones, use the __________ command.", answer: "split cells" },
      { section: "A", q: "13. The tab that contains the Table and Picture options is called the __________ tab.", answer: "insert" },
      { section: "A", q: "14. A __________ in Word allows users to jump to another document, a webpage, or another part of the same document.", answer: "hyperlink" },
      { section: "A", q: "15. When text is too long for one page, Word automatically moves it to the next page. This is called __________.", answer: "word wrap" },
      { section: "A", q: "16. The __________ tool checks your spelling and grammar mistakes in a document.", answer: "spelling and grammar checker" },
      { section: "A", q: "17. To make text bold, italic, or underlined, you use the tools in the __________ group.", answer: "font" },
      { section: "A", q: "18. You can change the font style and size from the __________ tab.", answer: "home" },
      { section: "A", q: "19. To select all the text in a document, press __________ + A on the keyboard.", answer: "ctrl" },
      { section: "A", q: "20. The part of the screen where you type your text is called the __________ area.", answer: "document" }
    ];

    const theoryData = [
      { q: "1. Name any three commands found in the Editing group on the Home tab.", expected: ["find", "replace", "select"] },
      { q: "2. Mention two types of places a hyperlink can lead to.", expected: ["webpage", "document", "email", "bookmark"] },
      { q: "3. Explain the difference between Cut and Copy.", expected: ["cut removes", "copy duplicates", "cut moves", "copy leaves original"] }
    ];

    const sectionAContainer = document.getElementById("sectionA");
    const sectionBContainer = document.getElementById("sectionB");

    // Generate Section A (Fill in the blanks)
    quizData.forEach((item, index) => {
      const div = document.createElement("div");
      div.className = "question";
      
      // Replace __________ with input field
      const questionText = item.q.replace(/__________/g, '<input type="text" class="fill-blank-input" id="a' + index + '" placeholder="Answer">');
      
      div.innerHTML = `<p>${questionText}</p>`;
      sectionAContainer.appendChild(div);
    });

    // Generate Section B (Theory questions)
    theoryData.forEach((item, index) => {
      const div = document.createElement("div");
      div.className = "question";
      div.innerHTML = `<p>${item.q}</p><textarea id="t${index}" placeholder="Type your detailed answer here..."></textarea>`;
      sectionBContainer.appendChild(div);
    });

    function checkTheoryAnswer(answer, expectedKeywords) {
      const lowerAns = answer.toLowerCase();
      let score = 0;
      expectedKeywords.forEach(keyword => {
        if (lowerAns.includes(keyword.toLowerCase())) score++;
      });
      const totalPossible = expectedKeywords.length;
      return Math.min(10, Math.round((score / totalPossible) * 10));
    }

    window.submitQuiz = async function() {
      const studentName = document.getElementById("studentName").value.trim();
      if (!studentName) {
        alert("Please enter your name before submitting.");
        return;
      }

      // Add loading state
      const submitBtn = document.querySelector('button');
      const originalText = submitBtn.textContent;
      submitBtn.textContent = 'Submitting...';
      submitBtn.classList.add('loading');

      let scoreA = 0;
      
      // Check Section A answers
      quizData.forEach((item, index) => {
        const userAnswer = document.getElementById(`a${index}`).value.trim().toLowerCase();
        const correctAnswer = item.answer.toLowerCase();
        const questionDiv = sectionAContainer.children[index];
        
        // Remove existing feedback
        const existingFeedback = questionDiv.querySelector('.feedback');
        if (existingFeedback) existingFeedback.remove();
        
        const feedbackDiv = document.createElement("div");
        feedbackDiv.className = "feedback";

        if (userAnswer === correctAnswer || 
            (correctAnswer.includes(userAnswer) && userAnswer.length > 2) ||
            (userAnswer.includes(correctAnswer) && correctAnswer.length > 2)) {
          scoreA++;
          feedbackDiv.className += " correct";
          feedbackDiv.innerHTML = `‚úÖ Correct!`;
        } else {
          feedbackDiv.className += " wrong";
          feedbackDiv.innerHTML = `‚ùå Incorrect. Correct answer: <strong>${item.answer}</strong>`;
        }
        questionDiv.appendChild(feedbackDiv);
      });

      let scoreB = 0;
      
      // Check Section B answers
      theoryData.forEach((item, index) => {
        const ans = document.getElementById(`t${index}`).value.trim();
        const questionScore = checkTheoryAnswer(ans, item.expected);
        scoreB += questionScore;
        
        const div = sectionBContainer.children[index];
        
        // Remove existing feedback
        const existingExpected = div.querySelector('.expected');
        if (existingExpected) existingExpected.remove();

        const expectedDiv = document.createElement("div");
        expectedDiv.className = "expected";
        expectedDiv.innerHTML = `<strong>Score: ${questionScore}/10</strong><br><strong>Expected keywords:</strong> ${item.expected.join(", ")}`;
        div.appendChild(expectedDiv);
      });

      const totalScore = scoreA + scoreB;
      const percentage = Math.round((totalScore / 50) * 100);

      // Show results
      const resultDiv = document.getElementById("result");
      resultDiv.style.display = "block";
      resultDiv.innerHTML = `
        <h3>üìä Quiz Results</h3>
        <p>Section A (Fill in the blanks): ${scoreA}/20 marks</p>
        <p>Section B (Theory): ${scoreB}/30 marks</p>
        <p><strong>Total Score: ${totalScore}/50 marks (${percentage}%)</strong></p>
        <p>${percentage >= 70 ? 'üéâ Excellent work!' : percentage >= 50 ? 'üëç Good job!' : 'üìö Keep studying!'}</p>
      `;

      // Scroll to results
      resultDiv.scrollIntoView({ behavior: 'smooth' });

      try {
        const newRef = push(ref(db, "quizScores"));
        await set(newRef, {
          name: studentName,
          sectionA: scoreA,
          sectionB: scoreB,
          totalScore: totalScore,
          percentage: percentage,
          timestamp: new Date().toISOString(),
          date: new Date().toLocaleDateString()
        });
        
        // Show success message
        const successDiv = document.createElement('div');
        successDiv.className = 'success-message';
        successDiv.innerHTML = '‚úÖ Quiz submitted and score saved successfully!';
        resultDiv.appendChild(successDiv);
        
      } catch (err) {
        console.error('Firebase error:', err);
        
        // Show error message
        const errorDiv = document.createElement('div');
        errorDiv.className = 'error-message';
        errorDiv.innerHTML = '‚ö†Ô∏è Quiz completed but could not save to database. Please contact your instructor.';
        resultDiv.appendChild(errorDiv);
      } finally {
        // Reset button
        submitBtn.textContent = originalText;
        submitBtn.classList.remove('loading');
      }
    }

    // Add some interactive effects
    document.addEventListener('DOMContentLoaded', function() {
      // Add focus effects to inputs
      const inputs = document.querySelectorAll('input, textarea');
      inputs.forEach(input => {
        input.addEventListener('focus', function() {
          this.parentElement.style.transform = 'scale(1.02)';
        });
        
        input.addEventListener('blur', function() {
          this.parentElement.style.transform = 'scale(1)';
        });
      });
    });
  </script>
</body>
</html>
